
<html>

<head>
<meta http-equiv="content-type" content="text/html;charset=GB2312">
<META http-equiv='Pragma' CONTENT='no-cache'>
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache">	
<meta name="generator" content="Adobe GoLive 5">
<title>路由器表格</title>
<link rel="stylesheet" href="/form1.css" type="text/css">
<script language="javascript" src="/browser.js"></script>
<script language="javascript" type="text/javascript" src="/utility.js"></script>
<script language="javascript" type="text/javascript">
<!--

function goTestApply(F)
{
	if (sumvalue(F)){	  
	  if(F.blankstate.value!=1)
	  {
	    document.formname.L2TPconnect.value=1;
	    document.formname.ResetFlag.value=1;
	    window.open('l2tpstatus.html', 'l2tp', 'width=380,height=350,status=yes');
	    setTimeout("document.formname.submit()",1000);
	   } else
	   document.formname.submit();
	   // window.open('test_conn.html', '');
	}
}

function loadcheck(){
	var x=document.formname.Spoofmac.value;
	var y="";
	var j=0;
	
	document.forms[0].IspName.selectedIndex=0;
	loadhelp('_l2tp',' ');
	if(isIE()){
		document.formname.L2TPUserName.size="24"
		document.formname.L2TPPasswd.size="24"
	}
	else{
		document.formname.L2TPUserName.size="15"
		document.formname.L2TPPasswd.size="15"
	}
	if (document.forms[0].L2TPPasswd.value=='onFocus="if')
		document.forms[0].L2TPPasswd.value="";
	if ((document.forms[0].L2TPPasswd.value=='AOL')&&(document.forms[0].L2TPUserName.value=='AOL'))
	{
		document.forms[0].L2TPUserName.value="";
		document.forms[0].L2TPPasswd.value="";		
	}
	document.forms[0].IspName.selectedIndex=3;
	disableItem();
	
	var system = OScheck();

	if(system.indexOf("Mac") >=0 ) {
		document.formname.L2TPMyAddr1.size="5"
		document.formname.L2TPMyAddr2.size="5"
		document.formname.L2TPMyAddr3.size="5"
		document.formname.L2TPMyAddr4.size="5"
		document.formname.L2TPAddr1.size="5"
		document.formname.L2TPAddr2.size="5"
		document.formname.L2TPAddr3.size="5"
		document.formname.L2TPAddr4.size="5"
		document.formname.PDAddr1.size="5"
		document.formname.PDAddr2.size="5"
		document.formname.PDAddr3.size="5"
		document.formname.PDAddr4.size="5"
		document.formname.DAddr1.size="5"
		document.formname.DAddr2.size="5"
		document.formname.DAddr3.size="5"
		document.formname.DAddr4.size="5"
		document.formname.Spoofmac.size="25"
	}
	else {
		document.formname.L2TPMyAddr1.size="4"
		document.formname.L2TPMyAddr2.size="4"
		document.formname.L2TPMyAddr3.size="4"
		document.formname.L2TPMyAddr4.size="4"
		document.formname.L2TPAddr1.size="4"
		document.formname.L2TPAddr2.size="4"
		document.formname.L2TPAddr3.size="4"
		document.formname.L2TPAddr4.size="4"
		document.formname.PDAddr1.size="4"
		document.formname.PDAddr2.size="4"
		document.formname.PDAddr3.size="4"
		document.formname.PDAddr4.size="4"
		document.formname.DAddr1.size="4"
		document.formname.DAddr2.size="4"
		document.formname.DAddr3.size="4"
		document.formname.DAddr4.size="4"
		document.formname.Spoofmac.size="17"
	}
	checkform(document.formname);
	if(document.formname.Spoofmac.value!="")
	{       
	        for(i=0;i<x.length;i++)
	        {
		        if(i==(j+2))
		        {
		          y=y+":";
		          j=j+2;
		         } 
		        y=y+x.charAt(i);
		        
		        }
	        document.formname.Spoofmac.value=y;	
	}
	changetext();
	setDNS();
}

function checkform(F)
{
	load4(F.DNSAddr1,F.DAddr1,F.DAddr2,F.DAddr3,F.DAddr4);
	if(F.DNSAddr2.value != '0.0.0.0')
		load4(F.DNSAddr2,F.PDAddr1,F.PDAddr2,F.PDAddr3,F.PDAddr4);
}
function Hex(val) {
	var h = (val-0).toString(16);
	if(h.length==1) h='0'+h;
	return h.toUpperCase();
}
function CheckServerIP(MyIp,ServerIp) {
	if(ServerIp.length==0) return true;
	var i1,i2,i3, wip, nip, gip;
	var netmaskIp = '255.255.255.0'

	i1=MyIp.indexOf('.');
	i2=MyIp.indexOf('.',(i1+1));
	i3=MyIp.indexOf('.',(i2+1));
	wip = Hex(MyIp.substring(0,i1)) + Hex(MyIp.substring((i1+1),i2)) +Hex(MyIp.substring((i2+1),i3))+Hex(MyIp.substring((i3+1),MyIp.length));
	wip = '0x'+wip;

	i1=netmaskIp.indexOf('.');
	i2=netmaskIp.indexOf('.',(i1+1));
	i3=netmaskIp.indexOf('.',(i2+1));
	nip = Hex(netmaskIp.substring(0,i1)) + Hex(netmaskIp.substring((i1+1),i2)) +Hex(netmaskIp.substring((i2+1),i3)) +Hex(netmaskIp.substring((i3+1),netmaskIp.length));
	nip = '0x'+nip;

	i1=ServerIp.indexOf('.');
	i2=ServerIp.indexOf('.',(i1+1));
	i3=ServerIp.indexOf('.',(i2+1));
	gip = Hex(ServerIp.substring(0,i1)) + Hex(ServerIp.substring((i1+1),i2)) +Hex(ServerIp.substring((i2+1),i3)) +Hex(ServerIp.substring((i3+1),ServerIp.length));
	gip = '0x'+gip;
	if((wip & nip) != (gip & nip)){
		alert('IP地址'+MyIp+' 未处于'+ServerIp+' 网络。');
		return false;
	}
}  
function sumvalue(F)
{
	var lanIp = '<% nvram_get("lan_ipaddr"); %>';
	var myIp,serverIp;

	F.PDAddr1.value=strim(F.PDAddr1.value);
	F.PDAddr2.value=strim(F.PDAddr2.value);
	F.PDAddr3.value=strim(F.PDAddr3.value);
	F.PDAddr4.value=strim(F.PDAddr4.value);
	
	if(!isValidName(F.L2TPUserName.value,60))
	{
		alert("登录名称类型无效。");
		F.L2TPUserName.focus();
		return false;		
	}        
/*	if(!isValidName(F.L2TPPasswd.value,50))
	{
		alert("密码名称类型无效。");
		F.L2TPPasswd.focus();
		return false;		
	}        
*/	
	if(isNumeric(F.L2TPIdleTime,255))
	{
		alert("闲置超时(分钟)的范围为0~255。");
		F.L2TPIdleTime.focus();
		return false;
	}
	if(parseInt(F.L2TPIdleTime.value) < 0)
	{
		alert("闲置超时(分钟)的范围为0~255。");
		F.L2TPIdleTime.focus();
		return false;
	}

	myIp = IPv4toString(getValue(F.L2TPMyAddr1.value), getValue(F.L2TPMyAddr2.value), getValue(F.L2TPMyAddr3.value), getValue(F.L2TPMyAddr4.value));
	serverIp = IPv4toString(getValue(F.L2TPAddr1.value), getValue(F.L2TPAddr2.value), getValue(F.L2TPAddr3.value), getValue(F.L2TPAddr4.value));
	
	//check My IP addr
	if (checkIP(F.L2TPMyAddr1, F.L2TPMyAddr2, F.L2TPMyAddr3, F.L2TPMyAddr4, 254))
	{
		alert("我的IP地址无效，请重新输入！");
		return false;
	}
	if(!isValidIP(myIp))
	{
		alert("我的IP地址无效，请重新输入！");
		return false;
	}
	if(isStringsEqual(myIp, lanIp))
	{
		alert("我的IP地址无效！ 我的IP地址与局域网IP地址不能相同。");
		return false;
	}
	
	//check Server IP addr
	if (checkIP(F.L2TPAddr1, F.L2TPAddr2, F.L2TPAddr3, F.L2TPAddr4, 254))
	{
		alert("服务器IP地址无效，请重新输入！");
		return false;
	}
	if(!isValidIP(serverIp))
	{
		alert("服务器IP地址无效，请重新输入！");
		return false;
	}
	if(isStringsEqual(serverIp, lanIp))
	{
		alert("服务器IP地址无效！ 服务器IP地址与局域网IP地址不能相同。");
		return false;
	}
	if(isStringsEqual(myIp, serverIp))	
	{
		alert("IP地址无效，我的IP地址与服务器IP地址相同。");
		return false;
	}
	
	if (CheckServerIP(myIp,serverIp) == false)
		return false; 
/*		
	if(!isValidName(F.L2TPConnectName.value,63))
	{
		alert("连接名称类型无效。");
		F.L2TPConnectName.focus();
		return false;		
	}        
*/
	if(F.DNSAssign[1].checked)
	{	
		//var wanIp = F.InAddr.value;
		F.DNSAddr1.value = IPv4toString(getValue(F.DAddr1.value), getValue(F.DAddr2.value), getValue(F.DAddr3.value), getValue(F.DAddr4.value));
		F.DNSAddr2.value = IPv4toString(getValue(F.PDAddr1.value), getValue(F.PDAddr2.value), getValue(F.PDAddr3.value), getValue(F.PDAddr4.value));
		
		//check primary dns addr
		if (checkIP(F.DAddr1, F.DAddr2, F.DAddr3, F.DAddr4, 254))
		{
			alert("首选域名服务器地址无效，请重新输入！");
			return false;
		}
		if(!isValidIP(F.DNSAddr1.value))
		{
			alert("首选域名服务器地址无效，请重新输入！");
			return false;
		}
		else if(isStringsEqual(F.DNSAddr1.value,lanIp))
		{
			alert("首选域名服务器地址无效，域名服务器地址与广域网或局域网的IP地址相同。");
			return false;		
		}
		
		//check secondary DNS addr
		if(F.PDAddr1.value.length>0 || F.PDAddr2.value.length>0 ||F.PDAddr3.value.length>0 ||F.PDAddr4.value.length>0 )
		{
			if (checkIP(F.PDAddr1, F.PDAddr2, F.PDAddr3, F.PDAddr4, 254))
			{
				alert("备用域名服务器地址无效，请重新输入！");
				return false;
			}
			if(F.DNSAddr2.value.length > 3 && !isValidIP(F.DNSAddr2.value))
			{
				alert("备用域名服务器地址无效，请重新输入！");
				return false;
			}
			else if(isStringsEqual(F.DNSAddr1.value, F.DNSAddr2.value))	
			{
				alert("备用域名服务器地址无效，域名服务器地址与备用域名服务器地址相同。");
				return false;
			}
			else if(isStringsEqual(F.DNSAddr2.value,lanIp))
			{
				alert("备用域名服务器地址无效，域名服务器地址与广域网或局域网的IP地址相同。");
				return false;		
			}
			else if(F.DNSAddr2.value.length <= 3 || F.DNSAddr2.value.length > 15 )
			{
				 F.DNSAddr2.value='0.0.0.0';  
			}
		}
	}
	else{
		F.DNSAddr1.value= '0.0.0.0';
		F.DNSAddr2.value= '0.0.0.0';
	}
	
	if (F.MACAssign[2].checked)
	{
		var macAddr;
		if (F.Spoofmac.value.indexOf(':') == -1) //can't find out
			macAddr = StringtoMac(F.Spoofmac.value);
		else
			macAddr = F.Spoofmac.value;
			
		if((isValidMAC(macAddr) == false))
		{
			alert("MAC地址无效");
			F.Spoofmac.focus();
			return false;
		}
		else{
			top.contents.location.href="contents_normal.html"
			return true;				
		}
	}
	add(F.DNSAddr1,F.DAddr1,F.DAddr2,F.DAddr3,F.DAddr4);
	add(F.DNSAddr2,F.PDAddr1,F.PDAddr2,F.PDAddr3,F.PDAddr4);
	if(F.blankstate.value!=1) 
		top.contents.location.href="contents_normal.html"
	return true;
}
/*pamela20060125
function chkMacLen(mac){
    var myRE = /[0-9a-fA-F]{12}/;        
	if((mac.value.length != 12) || (mac.value=="000000000000")||(myRE.test(mac.value)!=true)){
		alert("MAC地址无效");
		mac.value =MacAddress;
		return false;
	}else
	{
	  return true;
	  }
}
function MACAddressBlur(address)
{
	var myRE = /[0-9a-fA-F]{12}/;
	var MAC = address.value;	
	if(MAC.match(":"))
	{
		if( (MAC.indexOf(":", 0)!=2) ||
		    (MAC.indexOf(":", 3)!=5) ||
		    (MAC.indexOf(":", 6)!=8) ||
		    (MAC.indexOf(":", 9)!=11) ||
		    (MAC.indexOf(":", 12)!=14) )
		{
			alert("MAC地址无效");
			return false;
		}
		
	}	
	MAC = MAC.replace(/:/g,"");
	address.value = MAC;	
	if ((address.value.length != 12) || (address.value=="000000000000")||(myRE.test(address.value)!=true))	
	{
		alert("MAC地址无效");	
		return false;
	}
	else
	{
		//MacAddress=address.value;
		return true;
	}
}
*/ 
function loadhelp(fname,anchname) {
	if (anchname!=' ')
		top.helpframe.location.href="help/help"+fname+".html#"+anchname
	else
		top.helpframe.location.href="help/help"+fname+".html"

}
		
function goback()
{
window.location.replace("basicform.html");
}
function disableItem()
{	
	optionindex=document.forms[0].IspName.selectedIndex;
    if (document.forms[0].IspName.options[optionindex].value=="1")
    {
	   	//document.forms[0].L2TPUserName.value="AOL";
	   	//document.forms[0].L2TPPasswd.value="AOL";
  
	   	document.forms[0].DNSAssign[0].checked=true;
		document.forms[0].L2TPUserName.disabled=true;
		document.forms[0].L2TPPasswd.disabled=true;

		document.forms[0].L2TPIdleTime.disabled=true;
		document.forms[0].DNSAssign[0].disabled=true;
		document.forms[0].DNSAssign[1].disabled=true;
		document.forms[0].DAddr1.disabled=true;
		document.forms[0].DAddr2.disabled=true;
		document.forms[0].DAddr3.disabled=true;
		document.forms[0].DAddr4.disabled=true;
		document.forms[0].PDAddr1.disabled=true;
		document.forms[0].PDAddr2.disabled=true;
		document.forms[0].PDAddr3.disabled=true;
		document.forms[0].PDAddr4.disabled=true;
		
		document.forms[0].IspName.selectedIndex=1;
		location="basicform_aol.html"
	}
	else if (document.forms[0].IspName.options[optionindex].value=="2")
	{
		document.forms[0].L2TPUserName.disabled=true;
		document.forms[0].L2TPPasswd.disabled=true;

		document.forms[0].L2TPIdleTime.disabled=true;
		document.forms[0].DNSAssign[0].disabled=true;
		document.forms[0].DNSAssign[1].disabled=true;
		document.forms[0].DAddr1.disabled=true;
		document.forms[0].DAddr2.disabled=true;
		document.forms[0].DAddr3.disabled=true;
		document.forms[0].DAddr4.disabled=true;
		document.forms[0].PDAddr1.disabled=true;
		document.forms[0].PDAddr2.disabled=true;
		document.forms[0].PDAddr3.disabled=true;
		document.forms[0].PDAddr4.disabled=true;		
		
		document.forms[0].IspName.selectedIndex=2;
		
		location="basicform_ppptp.html"		
	}	
	else if (document.forms[0].IspName.options[optionindex].value=="3")
	{
		document.forms[0].L2TPUserName.disabled=true;
		document.forms[0].L2TPPasswd.disabled=true;

		document.forms[0].L2TPIdleTime.disabled=false;
		document.forms[0].DNSAssign[0].disabled=true;
		document.forms[0].DNSAssign[1].disabled=true;
		document.forms[0].DAddr1.disabled=true;
		document.forms[0].DAddr2.disabled=true;
		document.forms[0].DAddr3.disabled=true;
		document.forms[0].DAddr4.disabled=true;
		document.forms[0].PDAddr1.disabled=true;
		document.forms[0].PDAddr2.disabled=true;
		document.forms[0].PDAddr3.disabled=true;
		document.forms[0].PDAddr4.disabled=true;
		
		document.forms[0].IspName.selectedIndex=3;
		
		location="basicform_telstra.html"
	}
	else if(document.forms[0].IspName.options[optionindex].value=="4")
	{
		document.forms[0].L2TPUserName.disabled=false;
		document.forms[0].L2TPPasswd.disabled=false;

		document.forms[0].L2TPIdleTime.disabled=false;
		document.forms[0].DNSAssign[0].disabled=false;
		document.forms[0].DNSAssign[1].disabled=false;
		document.forms[0].DAddr1.disabled=false;
		document.forms[0].DAddr2.disabled=false;
		document.forms[0].DAddr3.disabled=false;
		document.forms[0].DAddr4.disabled=false;
		document.forms[0].PDAddr1.disabled=false;
		document.forms[0].PDAddr2.disabled=false;
		document.forms[0].PDAddr3.disabled=false;
		document.forms[0].PDAddr4.disabled=false;	
	}
	else
	{
		document.forms[0].L2TPUserName.disabled=false;
		document.forms[0].L2TPPasswd.disabled=false;

		document.forms[0].L2TPIdleTime.disabled=false;
		document.forms[0].DNSAssign[0].disabled=false;
		document.forms[0].DNSAssign[1].disabled=false;
		document.forms[0].DAddr1.disabled=false;
		document.forms[0].DAddr2.disabled=false;
		document.forms[0].DAddr3.disabled=false;
		document.forms[0].DAddr4.disabled=false;
		document.forms[0].PDAddr1.disabled=false;
		document.forms[0].PDAddr2.disabled=false;
		document.forms[0].PDAddr3.disabled=false;
		document.forms[0].PDAddr4.disabled=false;
		
		document.forms[0].IspName.selectedIndex=0;
		window.location.href="basicformpppoe.html"
	}
}

function changetext() 
{
	var temp = "";
	if(isIE()) {
		if(document.formname.MACAssign[0].checked) {
		 	document.formname.Spoofmac.style.color="#888888";
		}
		
		if(document.formname.MACAssign[1].checked) {
		 	document.formname.Spoofmac.style.color="#888888";
		}
		
		if(document.formname.MACAssign[2].checked) {
		 	document.formname.Spoofmac.style.color="#000000";
		}
	}
	else {
		temp = browserVer();
		//alert(temp);
		if(temp.indexOf("new") >=0 ) {		
			if(document.formname.MACAssign[0].checked) {
		 		document.formname.Spoofmac.style.color="#888888";
			}
			if(document.formname.MACAssign[1].checked) {
			 	document.formname.Spoofmac.style.color="#888888";
			}
			if(document.formname.MACAssign[2].checked) {
			 	document.formname.Spoofmac.style.color="#000000";
			}
		}
		else {
		}
	}
}

function Cancel()
{
	location="basicform_l2tp.html"
}

function RunTest(F) {
	
	F.DoTest.value="yes";
	goTestApply(F);
	F.DoTest.value="";
	
}

function strim(s)
{
var i=0;
var j=0;
var z="";

Loop:
for(i=0;i<s.length;i++)
{
    if(s.charAt(i)!=" ")
    {
       j=i;
       break Loop;
    }   
}
if(i==s.length)
   s="";
s=s.slice(j,s.length);

Loop2:
for(i=s.length-1;i>=0;i--)
{

 if(s.charAt(i)!=" ")
    {
       j=i;
       break Loop2;
    }   
}
s=s.slice(0,j+1);
return(s);
}

function setDNS()
{
	if(document.formname.DNSAssign[0].checked)
	{
	    document.formname.DNSAssign[1].checked = false;
	    document.formname.DAddr1.disabled = true;
	    document.formname.DAddr2.disabled = true;
	    document.formname.DAddr3.disabled = true;
	    document.formname.DAddr4.disabled = true;	
	    
	    document.formname.PDAddr1.disabled = true;
	    document.formname.PDAddr2.disabled = true;
	    document.formname.PDAddr3.disabled = true;
	    document.formname.PDAddr4.disabled = true;	    
	}
	else
	{
	    document.formname.DNSAssign[0].checked = false;
	    document.formname.DAddr1.disabled = false;
	    document.formname.DAddr2.disabled = false;
	    document.formname.DAddr3.disabled = false;
	    document.formname.DAddr4.disabled = false;	
	    
	    document.formname.PDAddr1.disabled = false;
	    document.formname.PDAddr2.disabled = false;
	    document.formname.PDAddr3.disabled = false;
	    document.formname.PDAddr4.disabled = false;	 	
	}
}
//-->
</script>


	</head>

	<body bgcolor="#ffffff"  leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" onload="loadcheck()">
		<form name="formname" action="cgi-bin/apply.cgi" method="POST" target="_parent"> 
		<input type="hidden" name="page" value="basicform1.html">
		<input type=hidden name="action" value="Apply">						
		<input type="hidden" name="Load" value="W">
		<input type=hidden name="DoTest" value="">
		<table border="0" cellpadding="0" cellspacing="3" width="100%">
			<tr>
				<td><img src="img/spacer.gif" width=142 height="1" border="0"><br><a href="javascript:loadhelp('_l2tp','isp')">				
				<b>因特网服务提供商</b></a></td>
				<td  align="right"><select name="IspName" class=ttext size="1" onChange="disableItem()">
				<option value='2' <% selected_match("wan_proto", "pptp"); %>>PPTP</option>
				<option value='3' <% selected_match("wan_proto", "telstra"); %>>Telstra Bigpond</option>
				<option value='0' <% selected_match("wan_proto", "pppoe"); %>>Other</option>
				<option value='4' <% selected_match("wan_proto", "l2tp"); %>>L2TP</option>				
				</select>
				</td>
			</tr>
			<tr>
				<td colspan="2">
					<img src="img/liteblue.gif" width="100%" height="2" border="0"> 
				</td>
			</tr>
			<tr>
				<td>
				<a href="javascript:loadhelp('_l2tp','login')"><b>登录</b></a></td>
				<input type="hidden" name="Encap" value="4">
				<input type="hidden" name="ResetFlag" value="0">

				<td width="50%" align="right"><input type="text" name="L2TPUserName" size="15" maxlength="60" tabindex="5" value="<% nvram_get("wan_l2tp_username"); %>"
				onFocus="if (formname.IspName.options[formname.IspName.selectedIndex].value!=4) this.form.IspName.focus();"></td>
			</tr>			
			<tr>
				<td><a href="javascript:loadhelp('_l2tp','Password')"><b>密码</b></a></td>
				<td width="50%" align="right"><input type="password" name="L2TPPasswd" size="15" maxlength="50" tabindex="6" value="<% nvram_get("wan_l2tp_password"); %>"
				onFocus="if (formname.IspName.options[formname.IspName.selectedIndex].value!=4) this.form.IspName.focus();"></td>
			</tr>
			<tr>
				<td><a href="javascript:loadhelp('_l2tp','idletime')"><b>闲置超时</b>(分钟)</a></td>
				<td width="50%" align="right"><input type="text" name="L2TPIdleTime" class="num" size="3" maxlength="3" value="<% nvram_get("wan_l2tp_idle_interval"); %>" tabindex="7" onkeypress="chk_num(event)"></td>
			</tr>
			<tr>
				<td colspan="2">
					<img src="img/liteblue.gif" width="100%" height="2" border="0"> 
				</td>
			</tr>
			<tr>
				<td><a href="javascript:loadhelp('_l2tp','myip')"><b>我的IP地址</b></td>
				<td width="50%" align="right">
				<img src="img/spacer.gif" width="220" height="1" border=0><br>
					<input type="text" class="num" name="L2TPMyAddr1" size="4" value="<% field_nvram_get("wan_l2tp_ipaddr", ".", "1"); %>" maxlength="3" tabindex="9"
					onFocus="if (formname.IspName.options[formname.IspName.selectedIndex].value!=4) this.form.IspName.focus();" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="L2TPMyAddr2" size="4" value="<% field_nvram_get("wan_l2tp_ipaddr", ".", "2"); %>" maxlength="3" tabindex="10"
					onFocus="if (formname.IspName.options[formname.IspName.selectedIndex].value!=4) this.form.IspName.focus();" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="L2TPMyAddr3" size="4" value="<% field_nvram_get("wan_l2tp_ipaddr", ".", "3"); %>" maxlength="3" tabindex="11"
					onFocus="if (formname.IspName.options[formname.IspName.selectedIndex].value!=4) this.form.IspName.focus();" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="L2TPMyAddr4" size="4" value="<% field_nvram_get("wan_l2tp_ipaddr", ".", "4"); %>" maxlength="3" tabindex="12"
					onFocus="if (formname.IspName.options[formname.IspName.selectedIndex].value!=4) this.form.IspName.focus();" onkeypress="chk_num(event)">
				</td>
			</tr>
			<tr>
				<td><a href="javascript:loadhelp('_l2tp','serverip')"><b>服务器IP地址</b></td>
				<td width="50%" align="right">
				<img src="img/spacer.gif" width="220" height="1" border=0><br>
					<input type="text" class="num" name="L2TPAddr1" size="4" value="<% field_nvram_get("wan_l2tp_server_ipaddr", ".", "1"); %>" maxlength="3" tabindex="13"
					onFocus="if (formname.IspName.options[formname.IspName.selectedIndex].value!=4) this.form.IspName.focus();" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="L2TPAddr2" size="4" value="<% field_nvram_get("wan_l2tp_server_ipaddr", ".", "2"); %>" maxlength="3" tabindex="14"
					onFocus="if (formname.IspName.options[formname.IspName.selectedIndex].value!=4) this.form.IspName.focus();" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="L2TPAddr3" size="4" value="<% field_nvram_get("wan_l2tp_server_ipaddr", ".", "3"); %>" maxlength="3" tabindex="15"
					onFocus="if (formname.IspName.options[formname.IspName.selectedIndex].value!=4) this.form.IspName.focus();" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="L2TPAddr4" size="4" value="<% field_nvram_get("wan_l2tp_server_ipaddr", ".", "4"); %>" maxlength="3" tabindex="16"
					onFocus="if (formname.IspName.options[formname.IspName.selectedIndex].value!=4) this.form.IspName.focus();" onkeypress="chk_num(event)">
				</td>
			</tr>			
			<!-- <tr>
			<td><a href="javascript:loadhelp('_l2tp','id')"><b>Connection Name (ID)</b></td>
			<td align=right><input type="text" name="L2TPConnectName" size="12" maxlength="63" tabindex="17" value="<% nvram_get("wan_l2tp_conn_id"); %>"></td>
			</tr> -->
		
			<tr>
				<td colspan="2">
					<img src="img/liteblue.gif" width="100%" height="2" border="0"> 
				</td>
			</tr>
</table>
<table width="100%">

			
			<tr>
				<td colspan="2"><a href="javascript:loadhelp('_l2tp','DNSaddress')"><b>域名服务器（DNS）地址 </b></a></td>
			</tr>
			<tr>
				<td colspan="2"><input type="radio" value="Dynamic" name="DNSAssign" tabindex="18" onclick="setDNS();" <% checked_match("wan_autodns", "1"); %>>从ISP处动态获取</td>
			</tr>
			<tr>
				<td colspan="2"><input type="radio" value="Fixed" name="DNSAssign" tabindex="19" onclick="setDNS();" <% checked_match("wan_autodns", "0"); %>>使用下面的域名服务器地址</td>
			</tr>
			<tr>
				<td><img src="img/spacer.gif" width="20" height="12" border="0">首选域名服务</td>
				<td width="50%" align="right">
				       <input type="hidden" name="DNSAddr1"
					onfocus="if (this.form.DNSAssign[0].checked) this.form.DNSAssign[0].focus();" 
					value="<% nvram_get("wan_dns1"); %>">
					<img src="img/spacer.gif" width="250" height="1" border=0><br>
					<input type="text" class="num" name="DAddr1" size="4" 
					onfocus="if (this.form.DNSAssign[0].checked) this.form.DNSAssign[0].focus();" 
					value="" maxlength="3"  tabindex="20" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="DAddr2" size="4" 
					onfocus="if (this.form.DNSAssign[0].checked) this.form.DNSAssign[0].focus();" 
					value="" maxlength="3"  tabindex="21" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="DAddr3" size="4" 
					onfocus="if (this.form.DNSAssign[0].checked) this.form.DNSAssign[0].focus();" 
					value="" maxlength="3"  tabindex="22" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="DAddr4" size="4" 
					onfocus="if (this.form.DNSAssign[0].checked) this.form.DNSAssign[0].focus();" 
					value="" maxlength="3"  tabindex="23" onkeypress="chk_num(event)">
				</td>
			</tr>
			<tr>
				<td><img src="img/spacer.gif" width="20" height="12" border="0">备用域名服务器</td>
				<td width="50%" align="right">
				        <input type="hidden" name="DNSAddr2"
					onfocus="if (this.form.DNSAssign[0].checked) this.form.DNSAssign[0].focus();" 
					value="<% nvram_get("wan_dns2"); %>">
					<input type="text" class="num" name="PDAddr1" size="4" 
					onfocus="if (this.form.DNSAssign[0].checked) this.form.DNSAssign[0].focus();" 
					value="" maxlength="3" tabindex="24" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="PDAddr2" size="4" 
					onfocus="if (this.form.DNSAssign[0].checked) this.form.DNSAssign[0].focus();" 
					value="" maxlength="3" tabindex="25" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="PDAddr3" size="4" 
					onfocus="if (this.form.DNSAssign[0].checked) this.form.DNSAssign[0].focus();" 
					value="" maxlength="3" tabindex="26" onkeypress="chk_num(event)">.
					<input type="text" class="num" name="PDAddr4" size="4" 
					onfocus="if (this.form.DNSAssign[0].checked) this.form.DNSAssign[0].focus();" 
					value="" maxlength="3" tabindex="27" onkeypress="chk_num(event)">
				</td>
			</tr>
	<tr>
		<td colspan="2">
			<img src="img/liteblue.gif" width="100%" height="2" border="0"> 
		</td>
	</tr>	
	<tr>
		<td colspan="2">
		<a href="javascript:loadhelp('_l2tp','localaddress')"><b>路由器MAC地址</b></a> 
		</td>
	</tr>
	<tr>
		<td colspan="2">
			<input type="radio" value="default" name="MACAssign" <% checked_match("wan_mac_mode", "0"); %> tabindex="32" onclick="changetext();">使用缺省MAC地址</td>
	</tr>
	<tr>
		<td colspan="2">
			<input type="radio" value="thisPC" name="MACAssign" tabindex="33" onclick="changetext();">使用计算机MAC地址</td>
	</tr>
	</table>
	<table border="0" cellpadding="0" cellspacing="3" width="100%">
	<tr>
		<td width="60%" align="left">
			<input type="radio" value="spoofmac" class="num" name="MACAssign" <% checked_match("wan_mac_mode", "2"); %> tabindex="35" onclick="changetext();">使用下面的MAC地址
		</td>
		<td width="50%" align="right">
			<input type="text" name="Spoofmac" class="num" maxlength="17" value="<% nvram_get("wan_spoofmac"); %>" 
			onfocus="if (this.form.MACAssign[0].checked) this.form.MACAssign[0].focus();if (this.form.MACAssign[1].checked) this.form.MACAssign[1].focus();" tabindex="34">
		</td>
	</tr>
			<input type="hidden" name="L2TPconnect" value="0">
			<input type="hidden" name="blankstate" value="<% nvram_get("blankstate"); %>">
			<input type="hidden" name="wanFinish" value="off">
	<tr>
		<td colspan="2">
			<img src="img/liteblue.gif" width="100%" height="2" border="0"> 
		</td>
	</tr>
	<tr>
		<td colspan="2" align="center">
		<input type="hidden" name="Button" value="Apply">
		<!--<input type="Button" value="__Apply" OnClick="if (sumvalue(this.form)) document.formname.submit();">-->
		<input type="Button" value="应用" OnClick="goTestApply(this.form)">
		<input type="Button" value="取消" onclick="Cancel()">
		<input type="Button" value="测试" OnClick="RunTest(this.form)">
		
		</td>
	</tr>
			
	</table>
</form>
		<p>&nbsp;</p>
</body>

</html>

